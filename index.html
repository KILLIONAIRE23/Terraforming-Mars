<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta content="width=device-width, initial-scale=1.0" name="viewport"/>
    <title>Terraforming Mars Tag Manager</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
            background: #000 url('wallpaper.jpg') no-repeat center center fixed;
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: white;
        }
        table {
            width: 100%;
            margin: 0 auto;
            border-collapse: collapse;
            background-color: rgba(0, 0, 0, 0.7);
            color: white;
        }
        th, td {
            padding: 10px;
            border: 1px solid #ccc;
        }
        th {
            background-color: rgba(255, 255, 255, 0.2);
        }
        button {
            margin: 5px;
            padding: 5px 10px;
            background-color: #333;
            color: white;
            border: none;
        }
        img {
            max-width: 100%;
            width: 40px;
            height: auto;
        }
        h1, h2 {
            background-color: rgba(0, 0, 0, 0.6);
            padding: 10px;
            display: inline-block;
        }
        #vpTracker, #trTracker {
            margin-top: 20px;
            background-color: rgba(0, 0, 0, 0.6);
            padding: 20px;
            display: inline-block;
            color: white;
        }
        #cardList {
            margin-top: 20px;
            padding: 20px;
            background-color: rgba(0, 0, 0, 0.6);
            color: white;
            text-align: left;
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
</head>
<body>
<h1>Terraforming Mars Tag Manager</h1>
<table>
    <thead>
    <tr>
        <th>Tag</th>
        <th>Count</th>
        <th>Actions</th>
    </tr>
    </thead>
    <tbody id="tagTable">
    <tr>
        <td><img alt="Earth Tag" src="https://killionaire23.github.io/Terraforming-Mars/Earth.png"/> Earth Tag</td>
        <td><span id="earthCount">0</span></td>
        <td><button onclick="changeCount('earth', 1)">Add</button><button onclick="changeCount('earth', -1')">Remove</button></td>
    </tr>
    <!-- Add more rows here for other tags as in your original code -->
    </tbody>
</table>
<h2 id="totalTags">Total Tags: 0</h2>
<!-- VP Tracker Section -->
<div id="vpTracker">
    <h2>Victory Points Tracker</h2>
    <p>Current VP: <span id="vpCount">0</span></p>
    <button onclick="changeVP(1)">Add VP</button>
    <button onclick="changeVP(-1)">Remove VP</button>
</div>
<!-- TR Tracker Section -->
<div id="trTracker">
    <h2>Terraforming Rating (TR) Tracker</h2>
    <p>Current TR: <span id="trCount">0</span></p>
    <button onclick="changeTR(1)">Add TR</button>
    <button onclick="changeTR(-1)">Remove TR</button>
</div>
<!-- Cards List Section -->
<div id="cardList">
    <h2>Cards Database</h2>
    <ul id="cards"></ul> <!-- Cards will be dynamically added here -->
</div>
<script>
    const tagCounts = {
        earth: 0,
        space: 0,
        animal: 0,
        plant: 0,
        building: 0,
        event: 0,
        science: 0,
        energy: 0,
        microbe: 0,
        jovian: 0,
        city: 0,
        venus: 0
    };

    function changeCount(tag, delta) {
        tagCounts[tag] += delta;
        if (tagCounts[tag] < 0) {
            tagCounts[tag] = 0;
        }
        document.getElementById(`${tag}Count`).innerText = tagCounts[tag];
        updateTotalTags();
    }

    function updateTotalTags() {
        const total = Object.values(tagCounts).reduce((a, b) => a + b, 0);
        document.getElementById('totalTags').innerText = `Total Tags: ${total}`;
    }

    let vpCount = 0;
    function changeVP(delta) {
        vpCount += delta;
        if (vpCount < 0) {
            vpCount = 0;
        }
        document.getElementById('vpCount').innerText = vpCount;
    }

    let trCount = 0;
    function changeTR(delta) {
        trCount += delta;
        if (trCount < 0) {
            trCount = 0;
        }
        document.getElementById('trCount').innerText = trCount;
    }

    let cardsDatabase = [];
    document.addEventListener('DOMContentLoaded', loadDatabaseAutomatically);

    function loadDatabaseAutomatically() {
        const fileUrl = 'https://raw.githubusercontent.com/killionaire23/Terraforming-Mars/main/Card%20Database%20Kami%20with%20tags.xlsx';

        fetch(fileUrl)
            .then(response => response.arrayBuffer())
            .then(data => {
                const workbook = XLSX.read(data, { type: 'array' });
                const firstSheetName = workbook.SheetNames[0];
                const worksheet = workbook.Sheets[firstSheetName];
                const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

                cardsDatabase = jsonData.slice(1).map((row, index) => {
                    return {
                        number: index + 1,
                        name: row[0],
                        vp: row[1],
                        tags: {
                            science: row[2],
                            building: row[3],
                            space: row[4],
                            microbe: row[5],
                            plant: row[6],
                            animal: row[7],
                            city: row[8],
                            earth: row[9],
                            jovian: row[10],
                            energy: row[11],
                            venus: row[12],
                            event: row[13]
                        }
                    };
                });
                displayCards(cardsDatabase);
            })
            .catch(error => {
                console.error('Error loading the database:', error);
            });
    }

    function displayCards(cards) {
        const cardListElement = document.getElementById('cards');
        cardListElement.innerHTML = '';
        cards.forEach(card => {
            const li = document.createElement('li');
            li.textContent = `Card #${card.number}: ${card.name} - VP: ${card.vp}`;
            cardListElement.appendChild(li);
        });
    }

    function searchCard() {
        const cardNumber = parseInt(document.getElementById('cardNumberInput').value);
        const card = cardsDatabase.find(c => c.number === cardNumber);
        const cardDetailsDiv = document.getElementById('cardDetails');

        if (card) {
            cardDetailsDiv.innerHTML = `<p><strong>Card:</strong> ${card.name}<br><strong>VP Earned:</strong> ${card.vp}</p>`;
            changeVP(parseInt(card.vp));

            for (const [tag, value] of Object.entries(card.tags)) {
                if (value === 1) {
                    changeCount(tag, 1);
                }
            }
        } else {
            cardDetailsDiv.innerHTML = '<p>Card not found. Please try a different number.</p>';
        }
    }
</script>

<!-- Card Details Text -->
<div id="cardDetailsText">
    <p>Card #1: Colonizer Training Camp - VP: 2<br>
    Card #2: Asteroid Mining Consortium - VP: 1<br>
    Card #3: Deep Well Heating - VP: 0<br>
    Card #4: Cloud Seeding - VP: 0<br>
    Card #5: Search For Life - VP: 0<br>
    Card #6: Inventors' Guild - VP: 0<br>
    Card #7: Martian Rails - VP: 0<br>
    Card #8: Capital - VP: Ref<br>
    Card #9: Asteroid - VP: 0<br>
    Card #10: Comet - VP: 0<br>
    Card #11: Big Asteroid - VP: 0<br>
    Card #12: Water Import From Europa - VP: Ref<br>
    Card #13: Space Elevator - VP: 2<br>
    Card #14: Development Center - VP: 0<br>
    Card #15: Equatorial Magnetizer - VP: 0<br>
    Card #16: Domed Crater - VP: 1<br>
    Card #17: Noctis City - VP: 0<br>
    Card #18: Methane From Titan - VP: 2<br>
    Card #19: Imported Hydrogen - VP: 0<br>
    Card #20: Research Outpost - VP: 0<br>
    <!-- And so on... -->
    </p>
</div>
</body>
</html>
